{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/angular-master-detail-table","result":{"data":{"markdownRemark":{"html":"<p>In the previous <a href=\"http://www.dzurico.com/generate-a-data-table-library-with-angular-6/\">post</a> we built a material data table, we have packaged as a library and we have learnt how to publish on npm.</p>\n<p>Today we want to improve it by adding the two functionalities displayed in the featured image above. To make it so, we need to made some adjustments:</p>\n<ol>\n<li>Expand the column when the object contains another object that we decided to be called \"<em>details\"</em>;</li>\n<li>use the \"<em>when</em>\" functionality provided by material;</li>\n<li>create a caret where we can click;</li>\n<li>add some cool animation;</li>\n<li>Bonus: add a search functionality;</li>\n<li>use the library.</li>\n</ol>\n<p>Let's define some mock data where we can work on. I'm quite lazy and without fantasy so looking around I found out an amazing package called <a href=\"https://github.com/marak/Faker.js/\">faker.js</a> thatÂ generate massive amounts of fake data in Node.js and the browser:</p>\n<pre><code>npm install faker --save-dev\n</code></pre>\n<p>When the installation is completed we can move in our \"<em>src/app.component.ts</em>\" file and generate them as follow:</p>\n<p>[gist id=\"087f38a5ab04bf43565cef1632afc8a0\"]</p>\n<p>If we run <em>ng serve</em> we can see something like that:</p>\n<p>[caption id=\"attachment_7309\" align=\"aligncenter\" width=\"1024\"]<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 700px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/360ea/Screen-Shot-2018-05-28-at-16.15.08.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.606557377049185%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABCklEQVQY042R247DIAxE8/8/WamtdgMh5n4zhHZIVG0fd6QQC3w82CzMPMaoEHPrrZSCsPeOFXFr2OtaaykFabMKJYR4/IpVqk1uizbmOI6cszHGWjs/a1NKgPUp5xwMoo88K/V+jFxKiBHhgjOYws66iZ0VHNKQaqasc368Rgk1CKpEo/fXR4sPAb8Yo1I7CoUQiMh7Dzc1tWvSSKiR/VPm5+Oo9Q+GzzyrKEonHGGH9bo2kUYnSODEXpps9GhtcmNMGA7zksz1o5QinNF2zgWzwNgw0UzJ/6xJbYP5Iiecv1SmrjB979dS91WF2y3d70Fu6IfFykTL6x/Ca1ntWBvGQ4TQ1Q6+WvsG33zNiANtxWEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2018 05 28 at 16 15 08\"\n        title=\"Screen Shot 2018 05 28 at 16 15 08\"\n        src=\"/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/a8200/Screen-Shot-2018-05-28-at-16.15.08.png\"\n        srcset=\"/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/52d5c/Screen-Shot-2018-05-28-at-16.15.08.png 175w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/1bae2/Screen-Shot-2018-05-28-at-16.15.08.png 350w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/a8200/Screen-Shot-2018-05-28-at-16.15.08.png 700w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/0ab52/Screen-Shot-2018-05-28-at-16.15.08.png 1050w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/360ea/Screen-Shot-2018-05-28-at-16.15.08.png 1220w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span> first result[/caption]</p>\n<p>Our table doesn't look so right. It contains a column called \"<em>details</em>\" that should disappear and it doesn't contains our sub-table but at least we have all the information we need.</p>\n<p>Let's open our library project:</p>\n<pre><code>cd projects/ngx-data-table/src/lib/ngx-data-table\n</code></pre>\n<p>And make all the changes step by step.</p>\n<p>- Filter the column details:</p>\n<p>In the</p>\n<pre><code>ngx-data-table.component.ts\n</code></pre>\n<p>we need to apply a small change:</p>\n<p>from:</p>\n<pre><code>this.displayedColumns = Object.keys(_data[0]);\n</code></pre>\n<p>to:</p>\n<pre><code>this.displayedColumns = Object.keys(_data[0]).filter(key => key !== 'details');\n</code></pre>\n<p>- An handler to expand and collapse a row:</p>\n<pre><code>expandedElement: Array;\ntoggleRow(row) {\n    if (this.expandedElement === row) {\n      this.expandedElement = null;\n    } else {\n      this.expandedElement = row;\n    }\n  }\n</code></pre>\n<p>- Implement the \"when\" functionality from <a href=\"https://material.angular.io/components/table/api\">angular/@material</a>:</p>\n<pre><code>isExpansionDetailRow = (i: number, row: Object) =>\n    row.hasOwnProperty('detailRow');\n</code></pre>\n<p>- Add some animation to make everything more cool when we expand/collapse the row:</p>\n<pre><code>animations: [\n    trigger('detailExpand', [\n      state(\n        'collapsed',\n        style({ height: '0px', minHeight: '0', visibility: 'hidden' })\n      ),\n      state('expanded', style({ height: '*', visibility: 'visible' })),\n      transition(\n        'expanded &#x3C;=> collapsed',\n        animate('225ms cubic-bezier(0.4, 0.0, 0.2, 1)')\n      ),\n    ]),\n  ]\n</code></pre>\n<p>In case you got lost somewhere this is the full source code:</p>\n<p>[gist id=\"1905eedcdf912240325d3cedf69a9cee\"]</p>\n<p>At the moment we can't appreciate the changes we made because we didn't modify our template, so why wasting time...let's do it straight away opening \"ngx-data-table.component.html\":</p>\n<p>- We change the first cell adding a caret: [gist id=\"958951f69f868d4c699aa3c61f3cde44\"]</p>\n<p>It will be displayed only if the object contains the <em>\"details\"</em> property and will flip down/up if the column is expanded/collapsed.</p>\n<p>- we implement the \"when\" functionality: [gist id=\"eb5510cfe579d765c94d3358c9a618e7\"]</p>\n<p>- We implement the recursion. In this case the only thing we need to do is to load the component itself passing the new array from details: [gist id=\"e8ee36a56643a3772f81128838df968d\"]</p>\n<p>And as usual this is the full html code: [gist id=\"785d7524aebd11afcc088c55174877ff\"]</p>\n<p>The last change we need to do is the enrichment in our \"<em>ngx-data-table-datasource.ts</em>\" adding a new row (hidden) all the time the object contains \"<em>details</em>\":</p>\n<pre><code>const rows = [];\n    filtered.forEach(\n      element =>\n        element.details\n          ? rows.push(element, {detailRow: true, element})\n          : rows.push(element)\n    );\n    return rows;\n</code></pre>\n<p>[gist id=\"5ccc9b6198a993a83ee8352f17087195\"]</p>\n<p>If we reload now the browser we'll get our result: <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 700px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/164b6/Screen-Shot-2018-05-28-at-16.59.55.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.97435897435898%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAABVUlEQVQoz42TiXKDMAxE+f9PJb7wQQCD02cppSnpZKohDChe7Uorhvv9Xmt9vERrbV3Xx+9YlmXf90tymOcZ/NJjbRLHcZQya67WXZM8cxKa9hJDjJO1jsv7AEzBljD8HAAlSSkZYyFSaU9w1yP1yCLh+A5eub9LvcqmaghhmqIPgYuGeQUG9BxH0/LvYOvcON5KKTFGhGzbRqVlXWG+zPIvMA0LFYQdsFXvfc75X+BaN6TCqd2ePu0Sn8CTBG3nUnTaAKClC5lF/4veKZ1yjonO4s+0U4oGE6zDWx0MJYwEs5B8EecLZhIswKvPMXTmrLQK7skwccc8VQg4p3T1OcbuEwPTfeiyj72vBKTOIVU9QjbHyH9TCBglsmGWB03Rs3P+Zsw4jk5k9w2LbJhB43XDMBZXiVO2vPX5IxtFHNBV33rUc4uHz07qF6ZfjtjWQLfjyfEFyrBtBRnFJIUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2018 05 28 at 16 59 55\"\n        title=\"Screen Shot 2018 05 28 at 16 59 55\"\n        src=\"/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/a8200/Screen-Shot-2018-05-28-at-16.59.55.png\"\n        srcset=\"/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/52d5c/Screen-Shot-2018-05-28-at-16.59.55.png 175w,\n/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/1bae2/Screen-Shot-2018-05-28-at-16.59.55.png 350w,\n/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/a8200/Screen-Shot-2018-05-28-at-16.59.55.png 700w,\n/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/164b6/Screen-Shot-2018-05-28-at-16.59.55.png 780w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>mmm ... maybe we need a bit of css: [gist id=\"28ccfa26447ab8e77c74ce3df7ed1c17\"]</p>\n<p>Now is much better we got our recursive (n-depth) level master detail table.</p>\n<h2>Bonus</h2>\n<p>At the beginning of the post I was talking about the search functionality however as the post was becoming too long, I decided to publish the project on <a href=\"https://github.com/daniele-zurico/ngx-nested-data-table\">github</a> and on npmjs.org:</p>\n<pre><code>https://www.npmjs.com/package/ngx-nested-data-table\n</code></pre>\n<p><strong>Feel free to download/fork or create tickets</strong> on github:</p>\n<pre><code>https://github.com/daniele-zurico/ngx-nested-data-table\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 700px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/59fbd/Screen-Shot-2018-05-28-at-17.05.53.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.63064833005895%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAAB3ElEQVQoz4VTi27bMAzU/3/aGixY1y4B1iRu0TS2/JBsS7Se9k5WW2Qtth4Eh2FMinfHMC6aStTp2fCyLKuqbJqmewMRTSsM0bPsD/x3WRyeLi9tXYuuY9774L2zthey73utNQqUUnoFghFYP6wQTg6OKPhgXQKLKxCZFdamPDJhRXxDir2P3qVnjPMKdvvj7v5+9+1mc/vz7vt2e7PZ7Pa75StYYzAvC+qB6m0Y9tEKr8hK6Y2ZXTRyokaHyc9htiaKetKDD2FxcW7JttpgPEayIHGa+oK6cuB1GMfF2EghKI8TdfDTbKeFxmgUpl50XNR6pjiz4/Hx4XA6np4Ox9Ov3W4YRxBKGoJmDCkIIJnId10jpejF65m0ZryqXs7ny+Xctk3XwoIaVnHOEVTwrUzOQULwhBfpx7bmdcVrrkmxLDKchJ4Q8FqVLGmOcTMshBuG3IJcXKJbWDYWbv9L2FyP1uOg0J/GoKSb1Gz0zIqi2O/3GO//3qBYCJFMclapIScZBsbl2I0PM38uxms+AYaMmD8VQ49hGN6XEUCjz8XgnC/I2/Z6cyYcv4J3DtTQ+rojyyJnvC8t8CGPrxgQHP8qJk3IZroQHn9DOIcY7wkpsShZcCwLbAfH6+I/+aady37Y7a4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2018 05 28 at 17 05 53\"\n        title=\"Screen Shot 2018 05 28 at 17 05 53\"\n        src=\"/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/a8200/Screen-Shot-2018-05-28-at-17.05.53.png\"\n        srcset=\"/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/52d5c/Screen-Shot-2018-05-28-at-17.05.53.png 175w,\n/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/1bae2/Screen-Shot-2018-05-28-at-17.05.53.png 350w,\n/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/a8200/Screen-Shot-2018-05-28-at-17.05.53.png 700w,\n/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/59fbd/Screen-Shot-2018-05-28-at-17.05.53.png 1018w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Don't ask me how that is possible to have <strong>123 downloads</strong> already because I've no clue!!! :D</p>\n<h2>Important and suggestions</h2>\n<p>I was thinking to add the voice recognition on the search bar ... if you think that it's worth it let me know and I'll do it otherwise enjoy it.</p>\n<p>If you enjoyed it please follow me on twitter <a href=\"https://twitter.com/DZurico\">@Dzurico</a></p>","frontmatter":{"date":"May 28, 2018","path":"/blog/angular-master-detail-table","title":"Angular Master detail table","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABR0lEQVQoz41SWXKFIBDk/hexEpdUtFLJkVx4BBRUcEvLlATzftIfFrY90z0jbH3Ctm3/YV7KT7bv+3Ec+wXSHReIXJbljwznrPpi0zTN80zvAIpHY8CM42idI9Jaa7S2kQwo8py1baukDC1hC6auayG+UUNqY0xT17zr8DU4l+8lg0+gCLBFHApPjHPO2hm9kCvIqo+KQUppA6jXdgc1ijVplp4z0z4CkAXT7tF64LneNWdxmjElFSaUUoaQQggMGV5xABMLKGmaemetNanpMw0SYxgGaELy32IsY/GwF/x6bsBv03rAE054zh6vecGapoGtuwC267rWAzo0Bdn3Pe+4eAhyOlewrlnxxjCPuy4DBQPDOQ+D0H8W4oGyeJYztlIKjcPVwQG7QT0yBh3iDB7xDctxwyaPMcIzgzJaOCLADMsDmSTJD5kBJ3mNFii2AAAAAElFTkSuQmCC","aspectRatio":1.45822102425876,"src":"/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/af144/master-detail.png","srcSet":"/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/7c0ed/master-detail.png 200w,\n/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/647de/master-detail.png 400w,\n/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/af144/master-detail.png 800w,\n/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/23495/master-detail.png 1082w","sizes":"(max-width: 800px) 100vw, 800px"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}