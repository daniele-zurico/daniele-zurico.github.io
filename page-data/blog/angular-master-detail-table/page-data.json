{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/angular-master-detail-table","result":{"data":{"markdownRemark":{"html":"<p>In the previous <a href=\"http://www.dzurico.com/generate-a-data-table-library-with-angular-6/\">post</a> we built a material data table, we have packaged as a library and we have learnt how to publish on npm.</p>\n<p>Today we want to improve it by adding the two functionalities displayed in the featured image above. To make it so, we need to made some adjustments:</p>\n<ol>\n<li>Expand the column when the object contains another object that we decided to be called \"<em>details\"</em>;</li>\n<li>use the \"<em>when</em>\" functionality provided by material;</li>\n<li>create a caret where we can click;</li>\n<li>add some cool animation;</li>\n<li>Bonus: add a search functionality;</li>\n<li>use the library.</li>\n</ol>\n<p>Let's define some mock data where we can work on. I'm quite lazy and without fantasy so looking around I found out an amazing package called <a href=\"https://github.com/marak/Faker.js/\">faker.js</a> thatÂ generate massive amounts of fake data in Node.js and the browser:</p>\n<pre><code>npm install faker --save-dev\n</code></pre>\n<p>When the installation is completed we can move in our \"<em>src/app.component.ts</em>\" file and generate them as follow:</p>\n<p>[gist id=\"087f38a5ab04bf43565cef1632afc8a0\"]</p>\n<p>If we run <em>ng serve</em> we can see something like that:</p>\n<p>[caption id=\"attachment_7309\" align=\"aligncenter\" width=\"1024\"]<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/cd138/Screen-Shot-2018-05-28-at-16.15.08.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVQY042Qy27EMAhF8/8f2VZtNck4NvgdjDGpnGjUTRc9YoU4XMTCzGMMZm6tiUi76CLMTEQiIkN8CM/n5hyuT7tt2/djXY3djVnQ+9vx3ocXOWdmRvSIs9l7L6kwswyRoUQt5tyZlxgjHcTM8eKW55xICOHaF+dptWeDzTnt/Xwx5fM8ichad2ciwp3mAJxzADB0dJL0sPXrU+rxK3vvVXWOOvA+lFIQfUyptYaIDgARhw5pkkyo4LQ1VT1Vp3z/qffeXtRaU0ql1OOg42LoaIHSuhe7n3zJd/LxF3VSaj2uqvN5uw9v7/XjoxjTANgYBljOf6BjBIwEyIg1Z7aWjSHEH87NzWBwJKsKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2018 05 28 at 16 15 08\"\n        title=\"Screen Shot 2018 05 28 at 16 15 08\"\n        src=\"/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/8c557/Screen-Shot-2018-05-28-at-16.15.08.png\"\n        srcset=\"/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/4edbd/Screen-Shot-2018-05-28-at-16.15.08.png 175w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/13ae7/Screen-Shot-2018-05-28-at-16.15.08.png 350w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/8c557/Screen-Shot-2018-05-28-at-16.15.08.png 700w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/e996b/Screen-Shot-2018-05-28-at-16.15.08.png 1050w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/cd138/Screen-Shot-2018-05-28-at-16.15.08.png 1220w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span> first result[/caption]</p>\n<p>Our table doesn't look so right. It contains a column called \"<em>details</em>\" that should disappear and it doesn't contains our sub-table but at least we have all the information we need.</p>\n<p>Let's open our library project:</p>\n<pre><code>cd projects/ngx-data-table/src/lib/ngx-data-table\n</code></pre>\n<p>And make all the changes step by step.</p>\n<p>- Filter the column details:</p>\n<p>In the</p>\n<pre><code>ngx-data-table.component.ts\n</code></pre>\n<p>we need to apply a small change:</p>\n<p>from:</p>\n<pre><code>this.displayedColumns = Object.keys(_data[0]);\n</code></pre>\n<p>to:</p>\n<pre><code>this.displayedColumns = Object.keys(_data[0]).filter(key => key !== 'details');\n</code></pre>\n<p>- An handler to expand and collapse a row:</p>\n<pre><code>expandedElement: Array;\ntoggleRow(row) {\n    if (this.expandedElement === row) {\n      this.expandedElement = null;\n    } else {\n      this.expandedElement = row;\n    }\n  }\n</code></pre>\n<p>- Implement the \"when\" functionality from <a href=\"https://material.angular.io/components/table/api\">angular/@material</a>:</p>\n<pre><code>isExpansionDetailRow = (i: number, row: Object) =>\n    row.hasOwnProperty('detailRow');\n</code></pre>\n<p>- Add some animation to make everything more cool when we expand/collapse the row:</p>\n<pre><code>animations: [\n    trigger('detailExpand', [\n      state(\n        'collapsed',\n        style({ height: '0px', minHeight: '0', visibility: 'hidden' })\n      ),\n      state('expanded', style({ height: '*', visibility: 'visible' })),\n      transition(\n        'expanded &#x3C;=> collapsed',\n        animate('225ms cubic-bezier(0.4, 0.0, 0.2, 1)')\n      ),\n    ]),\n  ]\n</code></pre>\n<p>In case you got lost somewhere this is the full source code:</p>\n<p>[gist id=\"1905eedcdf912240325d3cedf69a9cee\"]</p>\n<p>At the moment we can't appreciate the changes we made because we didn't modify our template, so why wasting time...let's do it straight away opening \"ngx-data-table.component.html\":</p>\n<p>- We change the first cell adding a caret: [gist id=\"958951f69f868d4c699aa3c61f3cde44\"]</p>\n<p>It will be displayed only if the object contains the <em>\"details\"</em> property and will flip down/up if the column is expanded/collapsed.</p>\n<p>- we implement the \"when\" functionality: [gist id=\"eb5510cfe579d765c94d3358c9a618e7\"]</p>\n<p>- We implement the recursion. In this case the only thing we need to do is to load the component itself passing the new array from details: [gist id=\"e8ee36a56643a3772f81128838df968d\"]</p>\n<p>And as usual this is the full html code: [gist id=\"785d7524aebd11afcc088c55174877ff\"]</p>\n<p>The last change we need to do is the enrichment in our \"<em>ngx-data-table-datasource.ts</em>\" adding a new row (hidden) all the time the object contains \"<em>details</em>\":</p>\n<pre><code>const rows = [];\n    filtered.forEach(\n      element =>\n        element.details\n          ? rows.push(element, {detailRow: true, element})\n          : rows.push(element)\n    );\n    return rows;\n</code></pre>\n<p>[gist id=\"5ccc9b6198a993a83ee8352f17087195\"]</p>\n<p>If we reload now the browser we'll get our result: <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/a1792/Screen-Shot-2018-05-28-at-16.59.55.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.71428571428572%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABb0lEQVQoz4VS25YcIQjs///THa9ICyJiJ7azk0xOdrferGNRQHEwtzHs+gtm1nu/3iFNps1/yIOZRURvzBtjDGbWrr2rmW2SuYn0MZ7PjSPn7H1w3qecN6Wqzjm/EFpr13XNOXPOznv+fD7FIjLGWJQZM29nm3P3b2bX1ziIqCACQEFMKSFiEwGA3cKuu93+Lw4hOufreQLAXgEA3MLxEn/lXB8PB1B67ymlvdgQYq30s5iZeu8i0kT2kCLPnNbw388MkLEgIhLRDkZVa61EhIil4Fmr3eGdtSLieZ7zc+EHAPgQYkxEvOup6sO5m4w+xCU2Q8SYUkzr25+oACDljOf5il9V8yIBSnkFuzwRifkt57J6KwDwugdVRcQQYs6ZiHY7zAwAtdLbhYWw+vPe39k+xT4E59zH4xFjYl5F14U5Xwq+ObfWRISZW2ubsvvUWmtEdC+OVZV4oXfZEWwc3ydpZruK3EHOOUVkG/wW/wK8CW1CE4IMEAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2018 05 28 at 16 59 55\"\n        title=\"Screen Shot 2018 05 28 at 16 59 55\"\n        src=\"/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/8c557/Screen-Shot-2018-05-28-at-16.59.55.png\"\n        srcset=\"/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/4edbd/Screen-Shot-2018-05-28-at-16.59.55.png 175w,\n/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/13ae7/Screen-Shot-2018-05-28-at-16.59.55.png 350w,\n/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/8c557/Screen-Shot-2018-05-28-at-16.59.55.png 700w,\n/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/a1792/Screen-Shot-2018-05-28-at-16.59.55.png 780w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>mmm ... maybe we need a bit of css: [gist id=\"28ccfa26447ab8e77c74ce3df7ed1c17\"]</p>\n<p>Now is much better we got our recursive (n-depth) level master detail table.</p>\n<h2>Bonus</h2>\n<p>At the beginning of the post I was talking about the search functionality however as the post was becoming too long, I decided to publish the project on <a href=\"https://github.com/daniele-zurico/ngx-nested-data-table\">github</a> and on npmjs.org:</p>\n<pre><code>https://www.npmjs.com/package/ngx-nested-data-table\n</code></pre>\n<p><strong>Feel free to download/fork or create tickets</strong> on github:</p>\n<pre><code>https://github.com/daniele-zurico/ngx-nested-data-table\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/3dde1/Screen-Shot-2018-05-28-at-17.05.53.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.71428571428572%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7ElEQVQoz32SfW/cIAzG8/0/2nXquvaPVW2v7U3dvRAIJGAw2JgpyfXUaV1/slACPLZ5oNPjMIcbeqOVUn3fD8Pg3onvJICDc296p36/HXtlh2Ecx05qlVqJaBon7z0uAECMEQBCCPMIELwn58hNJSXmeT8RdbnkUsp5dwgQAiasInVJKlVm1k+ulXlZONN9v7m5vbvbbDY/bm+/XV9vrq4eHx9bayLS/g+mWJk7SVsabho+NQ4Ni4QghThx1AAqEFAtkoD1MYWRqEjkegpJR8xVOqdfR/06mZ1TB70/MEArJCiCdQmpuVFuGGuOzNywzZFaQ2nd88vuafvy8vpr+/z88/5+8r4QYcZcci4ZS84ZuTIzq/5kjDZa90pppSJAp9Rpv98fjwdr5xsyxgzGaK2NMX3fK6WstUTcWvM+OGfdaK0bnLOYsVtNL6V87RAzAwRMOYYi3Co1wtaNCznn1eGPXGZmMXGYgnCLnsKYc5SC0u12u4eHh77v25eUUqy18yUhBvDrZDc/vZTWti91Pm07xtnuUsh7v3baaa2naYKFsFBK+VSMiCLnB3aujIj1nbVy/ReRnPPhcACAjxk7Zr40vOrXkZk/piMi51xK6S9x8H6apvXH+2CMWc8DAIO1tdbZ80V8Op1Wzy7iP1Rynn0MDaHHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2018 05 28 at 17 05 53\"\n        title=\"Screen Shot 2018 05 28 at 17 05 53\"\n        src=\"/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/8c557/Screen-Shot-2018-05-28-at-17.05.53.png\"\n        srcset=\"/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/4edbd/Screen-Shot-2018-05-28-at-17.05.53.png 175w,\n/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/13ae7/Screen-Shot-2018-05-28-at-17.05.53.png 350w,\n/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/8c557/Screen-Shot-2018-05-28-at-17.05.53.png 700w,\n/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/3dde1/Screen-Shot-2018-05-28-at-17.05.53.png 1018w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Don't ask me how that is possible to have <strong>123 downloads</strong> already because I've no clue!!! :D</p>\n<h2>Important and suggestions</h2>\n<p>I was thinking to add the voice recognition on the search bar ... if you think that it's worth it let me know and I'll do it otherwise enjoy it.</p>\n<p>If you enjoyed it please follow me on twitter <a href=\"https://twitter.com/DZurico\">@Dzurico</a></p>","frontmatter":{"date":"May 28, 2018","path":"/blog/angular-master-detail-table","title":"Angular Master detail table","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABcElEQVQoz12S3VKEMAyF+/6vs1eAOO6O46uIULqU9L+BODRS0e+CSTMk5yStSCkh4vYXPPmX4TgjElHz+BBYov1CzplOzsxRWI8c9/d3YYyx1nIL/t2WjDHG+8C5lPO6rtaYbTvK+Nu/dEJO0/P5vCrP8zx8Dk+lYoz7vhNRCH6apvHrK6VERKx0vz+Ecw4R/9mOMV7HQcRc2LZt33dWfnu8HcXspJJz3s+f6ra4Sz0SUdu2wnsfQkTcqrL33nlfj0QUCzXDym3TCgAYhkFKyZaISOsFAOoNENG6aiklx7W4aRqRUgoh+CLFuz1snzHjvQcA7s4ej+K2OWyzK3/Cva5Ya6HgnLOFDbHpXsQ4jgBQ95lzVrM6LmYc+f4R0Vo7S6mUiuU5xhiJqOtfhVKKF15Z9DJNEwBU7yGEeZ5D+HkzPHPXdcJYuxblWmyt0VpfO6aUnbM89u8L63vBw6wXAMAYc00uyyILWmtVCCHcbrdv2dgpAug2QnoAAAAASUVORK5CYII=","aspectRatio":1.4598540145985401,"src":"/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/ee604/master-detail.png","srcSet":"/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/69585/master-detail.png 200w,\n/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/497c6/master-detail.png 400w,\n/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/ee604/master-detail.png 800w,\n/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/95f1b/master-detail.png 1082w","sizes":"(max-width: 800px) 100vw, 800px"}}}}}},"pageContext":{}},"staticQueryHashes":["1135375505","3206378567"]}