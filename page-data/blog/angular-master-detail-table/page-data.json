{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/angular-master-detail-table","result":{"data":{"markdownRemark":{"html":"<p>In the previous <a href=\"http://www.dzurico.com/generate-a-data-table-library-with-angular-6/\">post</a> we built a material data table, we have packaged as a library and we have learnt how to publish on npm.</p>\n<p>Today we want to improve it by adding the two functionalities displayed in the featured image above. To make it so, we need to made some adjustments:</p>\n<ol>\n<li>Expand the column when the object contains another object that we decided to be called \"<em>details\"</em>;</li>\n<li>use the \"<em>when</em>\" functionality provided by material;</li>\n<li>create a caret where we can click;</li>\n<li>add some cool animation;</li>\n<li>Bonus: add a search functionality;</li>\n<li>use the library.</li>\n</ol>\n<p>Let's define some mock data where we can work on. I'm quite lazy and without fantasy so looking around I found out an amazing package called <a href=\"https://github.com/marak/Faker.js/\">faker.js</a> thatÂ generate massive amounts of fake data in Node.js and the browser:</p>\n<pre><code>npm install faker --save-dev\n</code></pre>\n<p>When the installation is completed we can move in our \"<em>src/app.component.ts</em>\" file and generate them as follow:</p>\n<p>[gist id=\"087f38a5ab04bf43565cef1632afc8a0\"]</p>\n<p>If we run <em>ng serve</em> we can see something like that:</p>\n<p>[caption id=\"attachment_7309\" align=\"aligncenter\" width=\"1024\"]<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/cd138/Screen-Shot-2018-05-28-at-16.15.08.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVQY042R3XKEIAyFff+HbHfazqoIREHCX8AetTu96UXPZKKGfOQIQymltYaccxaRfKmKoJJSQkWarNs2z5MxNM56mqav5zgqvSg10LrezLqi50f7vgMmWhH4rLUGH1DBRtJ6Stntey1lcM6lmLDgLt3w2SeCl2s/d1rjuivKxvRaj5dOGA841NrcM4nsPc1YawySbb3VJP6p+fNDOP7CcNt7P1uNhfEQAqw67/EjRAQUGbBk8Wpja3rO6D8QgO9zApxfYmbvfQgcY4qXAOct+XEJejnKBd+T41/iU4E5XsHn4S3r9vbOj0dQKltblCrWDsc/1FvbyCVLuADGRWgNOBF9A87NzWAPvaSMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2018 05 28 at 16 15 08\"\n        title=\"Screen Shot 2018 05 28 at 16 15 08\"\n        src=\"/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/8c557/Screen-Shot-2018-05-28-at-16.15.08.png\"\n        srcset=\"/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/4edbd/Screen-Shot-2018-05-28-at-16.15.08.png 175w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/13ae7/Screen-Shot-2018-05-28-at-16.15.08.png 350w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/8c557/Screen-Shot-2018-05-28-at-16.15.08.png 700w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/e996b/Screen-Shot-2018-05-28-at-16.15.08.png 1050w,\n/daniele-zurico.github.io/static/d12e0ad266aef74cda03ca52c2565af0/cd138/Screen-Shot-2018-05-28-at-16.15.08.png 1220w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span> first result[/caption]</p>\n<p>Our table doesn't look so right. It contains a column called \"<em>details</em>\" that should disappear and it doesn't contains our sub-table but at least we have all the information we need.</p>\n<p>Let's open our library project:</p>\n<pre><code>cd projects/ngx-data-table/src/lib/ngx-data-table\n</code></pre>\n<p>And make all the changes step by step.</p>\n<p>- Filter the column details:</p>\n<p>In the</p>\n<pre><code>ngx-data-table.component.ts\n</code></pre>\n<p>we need to apply a small change:</p>\n<p>from:</p>\n<pre><code>this.displayedColumns = Object.keys(_data[0]);\n</code></pre>\n<p>to:</p>\n<pre><code>this.displayedColumns = Object.keys(_data[0]).filter(key => key !== 'details');\n</code></pre>\n<p>- An handler to expand and collapse a row:</p>\n<pre><code>expandedElement: Array;\ntoggleRow(row) {\n    if (this.expandedElement === row) {\n      this.expandedElement = null;\n    } else {\n      this.expandedElement = row;\n    }\n  }\n</code></pre>\n<p>- Implement the \"when\" functionality from <a href=\"https://material.angular.io/components/table/api\">angular/@material</a>:</p>\n<pre><code>isExpansionDetailRow = (i: number, row: Object) =>\n    row.hasOwnProperty('detailRow');\n</code></pre>\n<p>- Add some animation to make everything more cool when we expand/collapse the row:</p>\n<pre><code>animations: [\n    trigger('detailExpand', [\n      state(\n        'collapsed',\n        style({ height: '0px', minHeight: '0', visibility: 'hidden' })\n      ),\n      state('expanded', style({ height: '*', visibility: 'visible' })),\n      transition(\n        'expanded &#x3C;=> collapsed',\n        animate('225ms cubic-bezier(0.4, 0.0, 0.2, 1)')\n      ),\n    ]),\n  ]\n</code></pre>\n<p>In case you got lost somewhere this is the full source code:</p>\n<p>[gist id=\"1905eedcdf912240325d3cedf69a9cee\"]</p>\n<p>At the moment we can't appreciate the changes we made because we didn't modify our template, so why wasting time...let's do it straight away opening \"ngx-data-table.component.html\":</p>\n<p>- We change the first cell adding a caret: [gist id=\"958951f69f868d4c699aa3c61f3cde44\"]</p>\n<p>It will be displayed only if the object contains the <em>\"details\"</em> property and will flip down/up if the column is expanded/collapsed.</p>\n<p>- we implement the \"when\" functionality: [gist id=\"eb5510cfe579d765c94d3358c9a618e7\"]</p>\n<p>- We implement the recursion. In this case the only thing we need to do is to load the component itself passing the new array from details: [gist id=\"e8ee36a56643a3772f81128838df968d\"]</p>\n<p>And as usual this is the full html code: [gist id=\"785d7524aebd11afcc088c55174877ff\"]</p>\n<p>The last change we need to do is the enrichment in our \"<em>ngx-data-table-datasource.ts</em>\" adding a new row (hidden) all the time the object contains \"<em>details</em>\":</p>\n<pre><code>const rows = [];\n    filtered.forEach(\n      element =>\n        element.details\n          ? rows.push(element, {detailRow: true, element})\n          : rows.push(element)\n    );\n    return rows;\n</code></pre>\n<p>[gist id=\"5ccc9b6198a993a83ee8352f17087195\"]</p>\n<p>If we reload now the browser we'll get our result: <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/a1792/Screen-Shot-2018-05-28-at-16.59.55.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.71428571428572%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXElEQVQoz4WSjXKDIBCEff83rYKgCAiK9oNLbOw06Y2TgQ17u/fTxbjuezlfopSScz7vkdZ0lOMX2MUYU0pbi6PFvu+AW95y3kgkIBopZWSOl+istUrpQSljrUBkGQYAQq/rigIgz4Di8/ogI4tUhUpBUJTJL/6J8310IYTZuWma+DXGOOfwx1UsSF5R+5us9YhNvyxwpAUcGnG/yO+Ufd8PCNNhlKWxpPM+/E+OMUBDDbdSJF2V/2rxn2ueJuso1zn8y2Ao1aMbAuA8u8X70obHAWRZluPZcMiTwuVoQoiSD3JPDyo4Kj1WcinQRmP4ePYzKshMmITX+CHbCtKH+Rps1cRdjLc5z9XbTIprHyDzFGEWA/NiB9u8oZrbhmld/bFNbbYPMp5Zsq++pxwWE3LdsEHRgpsygrSaxBwEKm3VuCLbGhdJh2GCscgIJLrPk+SFZEltkKTmIALEN7wJbUKF8XEBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2018 05 28 at 16 59 55\"\n        title=\"Screen Shot 2018 05 28 at 16 59 55\"\n        src=\"/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/8c557/Screen-Shot-2018-05-28-at-16.59.55.png\"\n        srcset=\"/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/4edbd/Screen-Shot-2018-05-28-at-16.59.55.png 175w,\n/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/13ae7/Screen-Shot-2018-05-28-at-16.59.55.png 350w,\n/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/8c557/Screen-Shot-2018-05-28-at-16.59.55.png 700w,\n/daniele-zurico.github.io/static/053f152be1af3c47c2a2e019042c4fd5/a1792/Screen-Shot-2018-05-28-at-16.59.55.png 780w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>mmm ... maybe we need a bit of css: [gist id=\"28ccfa26447ab8e77c74ce3df7ed1c17\"]</p>\n<p>Now is much better we got our recursive (n-depth) level master detail table.</p>\n<h2>Bonus</h2>\n<p>At the beginning of the post I was talking about the search functionality however as the post was becoming too long, I decided to publish the project on <a href=\"https://github.com/daniele-zurico/ngx-nested-data-table\">github</a> and on npmjs.org:</p>\n<pre><code>https://www.npmjs.com/package/ngx-nested-data-table\n</code></pre>\n<p><strong>Feel free to download/fork or create tickets</strong> on github:</p>\n<pre><code>https://github.com/daniele-zurico/ngx-nested-data-table\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/3dde1/Screen-Shot-2018-05-28-at-17.05.53.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.71428571428572%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4klEQVQoz31T23KbMBTU/3+a00ld56EZO76QSYwRAgmQkNC1C7I97jTNzpkzWJzLsisT1rVziLZuGKW0ruu2bcUN4w1aqVKID1bQz49LTXnbdl1HYggI51zf9cMwmAVKKTQgSynnjBgGJ4QTvdXa+7keIJOdrLXXapRKabQJEQPDMjfOyI8+BO+XF1eQn+v15uVltVr92mx+PD+vnp52u11KCe/S/2H0iEEk6r1r18m8JS+TsVHKaJ3XfmRKUemUCzZq5dlFy845G0cfKqnZaKYQiWCnjp36phC0ZOfSK5WsiyZGcJ8jhim5KZkxTKP3Ppk0h0aOiRyOxdv+eDy97w+H36+vEM06ZyYDLRAGeTIeFL2nddU0rGGsphTGQE9CaXU+ny+XkvPZoaZpWpQwhgfYBvM45855fOcwSCG46DgXqORYQLLoEPx7hbAZfhk9jdJGn4JLziTSLQC5rPAj7idzs/Oyl2gbBydRPkZrIimKYrvdgmH6FqAG/rNJxkg15EMyXz2tM+37ni9poxLZWoeLmJkSaNP3vVogF2DQl83YGeP1gl034yjckDeHfxEjVpVliQWPEwlG3gnn/pxx/jgOjsBIfOBfzfi7gHb+ASdhb/4eLGk5R9us+dJcVVXW7I4/VHKefXMvST4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2018 05 28 at 17 05 53\"\n        title=\"Screen Shot 2018 05 28 at 17 05 53\"\n        src=\"/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/8c557/Screen-Shot-2018-05-28-at-17.05.53.png\"\n        srcset=\"/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/4edbd/Screen-Shot-2018-05-28-at-17.05.53.png 175w,\n/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/13ae7/Screen-Shot-2018-05-28-at-17.05.53.png 350w,\n/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/8c557/Screen-Shot-2018-05-28-at-17.05.53.png 700w,\n/daniele-zurico.github.io/static/4e2c89ee14fb6f571bf2f7dca79319d0/3dde1/Screen-Shot-2018-05-28-at-17.05.53.png 1018w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Don't ask me how that is possible to have <strong>123 downloads</strong> already because I've no clue!!! :D</p>\n<h2>Important and suggestions</h2>\n<p>I was thinking to add the voice recognition on the search bar ... if you think that it's worth it let me know and I'll do it otherwise enjoy it.</p>\n<p>If you enjoyed it please follow me on twitter <a href=\"https://twitter.com/DZurico\">@Dzurico</a></p>","frontmatter":{"date":"May 28, 2018","path":"/blog/angular-master-detail-table","title":"Angular Master detail table","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXUlEQVQoz11S2XKDMAz0//8OT4aQCUynv1IC5rA5DNgJXaxBdbMPjLRIWh0W+75771//4S98MGQ774/jkOW38MF6R3DOHRcu5kxkl+y8+BLTNM3zTCUofA4MeGtX4nbnjDGgIAuXvvktE6pp+r6Pldu2rX6qvuu2bYOLuHW1TdPUzydmhEtKRVGKZVngfLSNtHgc2C4AmnBJ+VE+zmTqhIGg9xXE26Iq7CIlTVNhMdkKnRcrg1msZRdxWwAzpJzKVIzjWFWVUopaAqv1AJIvAMYYjQCyOVlKKbCDFQsJUrTbs+3LJuAvylF16vFMTuXZNnVlL1CtGLjcGIAFzQGYW2Y3Udc1WN4n0LXdeZi6pvsDMFqlOhwvPEcoQTnL7wIULZwx6AHJqMi9oxccH19yaeYsywRekwnKnIzXpbWOK+67Q7809t8Ly3NBw5gIcPE2Y3IYBhWAol0AukiS5BfZ2CkCSFvGYgAAAABJRU5ErkJggg==","aspectRatio":1.4598540145985401,"src":"/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/ee604/master-detail.png","srcSet":"/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/69585/master-detail.png 200w,\n/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/497c6/master-detail.png 400w,\n/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/ee604/master-detail.png 800w,\n/daniele-zurico.github.io/static/8d4f9fed0b1c28d0e1b91beb12a841b0/95f1b/master-detail.png 1082w","sizes":"(max-width: 800px) 100vw, 800px"}}}}}},"pageContext":{}},"staticQueryHashes":["1135375505","1135375505","3206378567"]}